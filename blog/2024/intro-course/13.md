---
title: "【第13回】グラフ"
description: "BFS、DFSを紹介します"
date: "2024-10-28"
authors: ["hana-rs"]
tags: ["入門講習会", "atcoder", "競技プログラミング", "cpp"]
---

## グラフの問題について

- ABCの問題ではD問題でグラフの問題が出題されることが多い。解けるようになると一気に4完に近づくことができる。

### グラフとは？用語解説

- 夏休み講習会の内容をつかいます。
<https://members.maximum.vc/assets/per-year/2024/graph-intro.pdf>

## BFS(幅優先探索)

- 幅優先探索は、与えられたノードから近い順に探索するアルゴリズム。
- グラフの最短経路を求めたい時によく使われる。
- キューを使って実装する。
- キューに始点を入れ、キューが空になるまで以下の処理を繰り返す。
  - キューから要素を取り出す。
  - 取り出した要素に隣接する頂点をキューに入れる。

- 仕組みについては以下の記事がわかりやすい。
  - BFSとDFSの解説
<https://qiita.com/drken/items/996d80bcae64649a6580>

### 例題

<https://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_11_C&lang=ja>

:::details[ヒント]

- 先ほどの記事(<https://qiita.com/drken/items/996d80bcae64649a6580>
)内のBFSテンプレを書き換えると解くことができます。
- どう動いているのか確認しながら解いてみてください。

:::

:::details[解答例]

```cpp
#include <bits/stdc++.h>
using namespace std;
#if __has_include(<atcoder/all>)
#include <atcoder/all>
using namespace atcoder;
#endif
using ll = long long;
#define rep(i, n) for (ll i = 0; i < (n); ++i)
#include <iostream>
#include <vector>
#include <queue>
using namespace std;
using Graph = vector<vector<int>>;

int main() {
    // 頂点数
    ll n; cin >> n;

    // グラフ入力受取
    Graph G(n);
    rep(i, n) {
        ll u,k; cin >> u >> k;
        rep(j, k) {
            ll c; cin >> c;
            G[u-1].push_back(c-1);
        }
    }

    // BFS 
    vector<ll> dist(n, -1); // 全頂点を「未訪問」に初期化
    queue<ll> que;

    // 初期条件 (頂点 0 を初期ノードとする)
    dist[0] = 0;
    que.push(0); // 0 を橙色頂点にする
    
    // BFS 開始 (キューが空になるまで探索を行う)
    while (!que.empty()) {
        ll v = que.front(); // キューから先頭頂点を取り出す
        que.pop();

        // v から辿れる頂点をすべて調べる
        for (ll nv : G[v]) {
            if (dist[nv] != -1) continue; // すでに発見済みの頂点は探索しない

            // 新たな白色頂点 nv について距離情報を更新してキューに追加する
            dist[nv] = dist[v] + 1;
            que.push(nv);
        }
    }

    // 結果出力 (各頂点の頂点 0(+1) からの距離を見る)
    for (ll v = 0; v < n; ++v) cout << v+1 << " " << dist[v] << endl;
}
```

:::

### 演習問題

<https://atcoder.jp/contests/abc007/tasks/abc007_3>
<https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_e>

## DFS(深さ優先探索)

- 深さ優先探索は、与えられたノードから可能な限り深く探索するアルゴリズム。
- スタックを使って実装する。
- スタックに始点を入れ、スタックが空になるまで以下の処理を繰り返す。
  - スタックから要素を取り出す。
  - 取り出した要素に隣接する頂点をスタックに入れる。

## 練習問題

<https://atcoder.jp/contests/abc190/tasks/abc190_b>

<https://atcoder.jp/contests/abc189/tasks/abc189_b>

<https://atcoder.jp/contests/abc251/tasks/abc251_c>

<https://atcoder.jp/contests/abc225/tasks/abc225_d>
