---
title: "【第13回】GoとMySQLをDockerで繋いでみよう"
description: "バックエンドとしてGo言語を使ってMySQLと繋いでみましょう。"
date: "2025-01-06"
authors: ["batora9"]
tags: ["Web研究会", "バックエンド", "Go", "MySQL", "Docker"]
prev: "./12"
---

## Goとは

GoはGoogleが開発したプログラミング言語であり、静的型付け、C言語に則ったコンパイル言語、メモリ安全性、ガベージコレクション、並行性の特徴を持ちます。

主にWebアプリケーションのバックエンド開発に使われます。

## Goのインストール

Ubuntu上でGoをインストールします。以下のコマンドで最新バージョンの1.23.4をダウンロードします。

Ubuntu 22.04.5 LTS/Intel 64bitの場合

```bash
wget https://go.dev/dl/go1.23.4.linux-amd64.tar.gz
```

その他のバージョンについては以下のサイトを参照してください。

<https://go.dev/dl/>

ダウンロードしたファイルを`/usr/local`に展開します。

```bash
tar -C /usr/local -xzf go1.23.4.linux-amd64.tar.gz
```

:::details[既にGoがインストールされている場合]

インストールされているGoのバージョンを確認します。

```bash
go version
```

`/usr/local/go`にインストールされている古いバージョンのGoを削除し、最新バージョンを展開します。

```bash
rm -rf /usr/local/go && tar -C /usr/local -xzf go1.23.4.linux-amd64.tar.gz
```

:::

`/usr/local/go/bin`を`$PATH`に追加します。`$HOME/.profile`をVSCodeで開きパスを追加します。

```bash
code $HOME/.profile
```

以下の行を追加してください。

```bash
export PATH=$PATH:/usr/local/go/bin
```

バージョンを確認します。

```bash
go version
```

`go version go1.23.4 linux/amd64`と表示されればインストール成功です。

## Hello World

作業ディレクトリ`golang-intro`を作成し、`main.go`を作成します。

`main.go`に以下のコードを記述します。

```go
package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}
```

### 実行方法

Goはコンパイル言語なので、先にコンパイルを行い実行用のファイルを作成する必要があります。

`go run`コマンドを使うことで「コンパイル」と「実行」を同時に行うことができます。

```bash
go run main.go
```

`Hello, World!`と表示されれば成功です。

## Goの基礎文法

押さえておきたいGoの基礎文法を簡単に紹介します。

### パッケージ宣言

すべてのGoファイルはパッケージ宣言から始まり、mainパッケージがプログラムの開始点です。

```go
package main
```

### インポート宣言

外部パッケージを利用するための宣言です。複数のパッケージをインポートする場合は`()`で囲みます。

```go
import (
 "fmt"
 "time"
 _ "os"
)
```

`_`はパッケージをインポートしているが、そのパッケージを使っていないことを示します。

### 主なデータ型

Goの主なデータ型は以下の通りです。

| データ型 | 説明 | 例 |
| --- | --- | --- |
| bool | 真偽値 | true, false |
| string | 文字列 | "Hello, World!" |
| int | 整数 | 100 |
| float64 | 浮動小数点数 | 3.14 |
| byte | バイト, 符号なし8ビット整数 uint8 の別名 | 'A' |

### 変数宣言

変数の宣言と同時に特定の値で初期化するには次のように記述します。

`var 変数名 データ型 = 初期値`

```go
var message string = "Hello, World!"
var number int = 100
var isTrue bool = true
```

Goは型推論が可能なので、データ型を省略することもできます。

```go
var message = "Hello, World!"
var number = 100
var isTrue = true
```

`:=`を使って`var`を省略することもできます。(Goではこの書き方がよく使われるため慣れておきましょう)

```go
message := "Hello, World!"
number := 100
isTrue := true
```

### 配列とスライス

Goの配列は宣言した時点で型とサイズが決められます。それに対して、スライスはサイズは決められておらず必要に応じて要素を追加できます。

スライスに要素を追加するには`append`関数を使います。

```go
// 配列
numbers := [3]int{1, 2, 3}
fmt.Println(numbers) // [1 2 3]
fmt.Println(numbers[0]) // 1

// スライス
foods := []string{"apple", "banana", "orange"}

// 要素の追加
foods = append(foods, "grape")

fmt.Println(foods) // [apple banana orange grape]
```

### マップ

マップはキーと値のペアを持つデータ構造です。

`map[キーのデータ型]値のデータ型`で宣言します。

```go
prices := map[string]int{
    "apple":  100,
    "banana": 200,
    "orange": 150,
}

// bananaの値を取得
fmt.Println(prices["banana"]) // 200
```

### nilとゼロ値

Goにおける`nil`とゼロ値は異なる目的で使用されますがどちらも「初期化」や「未設定」を意味する値です。

> Goにおける`nil`は、ポインタ、スライス、マップ、チャネル、インターフェースといった特定のデータ型で「無効」または「未設定」を意味する値として使用されます。

<https://ittrip.xyz/go/go-nil-zero-values>より引用

ゼロ値は変数が初期化されていない場合に自動的に割り当てられる値です。例えば、数値型であれば`0`、文字列型であれば`""`、ブール型であれば`false`です。

Goの関数では通常、戻り値としてエラーを返し、エラーかどうかを判定するために`nil`を使います。

```go
// text.txtファイルを開く
file, err := os.Open("./text.txt")
if err != nil {
    fmt.Println("ファイルを開くことができませんでした") // エラーが発生した場合はerrはnilではない
    return
} else {
    fmt.Println("ファイルを開くことができました")
}
```

## MySQLとは

MySQLは世界で最も人気があり、広く使われているオープンソースのリレーショナルデータベース(RDBMS)です。

Web研では以前、SQLiteを使ったデータベースの講義を行いました。SQLiteはサーバーレスつまりファイルベースであり、直接ファイルに読み書きを行います。そのため、インストールや設定が不要であり、自己完結型でOSへの依存度が低いのが特徴です。

一方、MySQLはクライアントサーバーモデルに準拠しており、**実行するにはサーバーが必要**となります。MySQLはプラットフォームに依存しないため、どのOSでも動作し、様々なプログラミング言語と互換性があるのが特徴です。

Web研の第8回の講義内でデータベースに関する詳しい説明があります。

<https://blog.maximum.vc/blog/2024/webken/8>

## Dockerとは

Dockerはコンテナ型の仮想環境を作成・実行・管理するためのプラットフォームです。

以前にDocker入門講習会を行いましたので、詳しい説明は以下の記事を参照してください。

<https://docs.docker.jp/get-started/toc.html>

:::details[Dockerのインストール方法]

Docker Desktopをインストールします。

<https://docs.docker.com/get-started/get-docker/>

Docker Desktopを起動し、`Settings -> Resources -> WSL Integration`からWSL2を有効にします。

:::

## DockerでGoとMySQLを繋ぐ
